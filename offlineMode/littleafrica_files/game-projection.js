/**
 * Represents a search trough an array.
 * @function search
 * @param {Array} array - The array you wanna search trough
 * @param {string} key - The key to search for
 * @param {string} [prop] - The property name to find it in
 */


var json = {"version":"1.0","encoding":"UTF-8","feed":{"xmlns":"http://www.w3.org/2005/Atom","xmlns$openSearch":"http://a9.com/-/spec/opensearchrss/1.0/","xmlns$gsx":"http://schemas.google.com/spreadsheets/2006/extended","id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Little Africa - African diaspora"},"link":[{"rel":"alternate","type":"application/atom+xml","href":"https://docs.google.com/a/benmoren.com/spreadsheets/d/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/pubhtml"},{"rel":"http://schemas.google.com/g/2005#feed","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full"},{"rel":"http://schemas.google.com/g/2005#post","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full"},{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full?alt\u003djson-in-script"}],"author":[{"name":{"$t":"ben"},"email":{"$t":"ben@benmoren.com"}}],"openSearch$totalResults":{"$t":"30"},"openSearch$startIndex":{"$t":"1"},"entry":[{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cokwr"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Everyone: Together as a wave, flow forward and back. You are the rising sea, slowly inching up the shore of an island nation. "},"content":{"type":"text","$t":"lowplayers: all, highplayers: all, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cokwr"}],"gsx$prompt":{"$t":"Everyone: Together as a wave, flow forward and back. You are the rising sea, slowly inching up the shore of an island nation. "},"gsx$lowplayers":{"$t":"all"},"gsx$highplayers":{"$t":"all"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cpzh4"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"One person is a farmer, working in their field. Others are corn, sorgum, and bean seeds sprouting."},"content":{"type":"text","$t":"lowplayers: 4, highplayers: 8, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cpzh4"}],"gsx$prompt":{"$t":"One person is a farmer, working in their field. Others are corn, sorgum, and bean seeds sprouting."},"gsx$lowplayers":{"$t":"4"},"gsx$highplayers":{"$t":"8"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cre1l"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Become corn, sorghum, or beans growing in a field. Corn: wither from drought. Sorghum and beans grow taller and taller. "},"content":{"type":"text","$t":"lowplayers: 6, highplayers: 8, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cre1l"}],"gsx$prompt":{"$t":"Become corn, sorghum, or beans growing in a field. Corn: wither from drought. Sorghum and beans grow taller and taller. "},"gsx$lowplayers":{"$t":"6"},"gsx$highplayers":{"$t":"8"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/chk2m"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Move together as a school of herring fish, darting to and fro. Flee a warming sea!"},"content":{"type":"text","$t":"lowplayers: 6, highplayers: 8, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/chk2m"}],"gsx$prompt":{"$t":"Move together as a school of herring fish, darting to and fro. Flee a warming sea!"},"gsx$lowplayers":{"$t":"6"},"gsx$highplayers":{"$t":"8"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/ciyn3"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"You are hungry puffins in a flock, flying, waddling, and diving as you search for schools of herring that have started to swim to colder waters. Squawk to eachother!"},"content":{"type":"text","$t":"lowplayers: 2, highplayers: 4, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/ciyn3"}],"gsx$prompt":{"$t":"You are hungry puffins in a flock, flying, waddling, and diving as you search for schools of herring that have started to swim to colder waters. Squawk to eachother!"},"gsx$lowplayers":{"$t":"2"},"gsx$highplayers":{"$t":"4"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/ckd7g"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"One group is a cluster of pine trees in the Rocky Mountains. Another is a pine beetle colony spreading north in a warming world, infesting pines!"},"content":{"type":"text","$t":"lowplayers: 8, highplayers: 10, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/ckd7g"}],"gsx$prompt":{"$t":"One group is a cluster of pine trees in the Rocky Mountains. Another is a pine beetle colony spreading north in a warming world, infesting pines!"},"gsx$lowplayers":{"$t":"8"},"gsx$highplayers":{"$t":"10"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/clrrx"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"You are frogs living in an endangered mountaintop cloud forest. Crouch down, and hop to squish closer and closer together as climate change shrinks your forest home."},"content":{"type":"text","$t":"lowplayers: 6, highplayers: 8, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/clrrx"}],"gsx$prompt":{"$t":"You are frogs living in an endangered mountaintop cloud forest. Crouch down, and hop to squish closer and closer together as climate change shrinks your forest home."},"gsx$lowplayers":{"$t":"6"},"gsx$highplayers":{"$t":"8"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cyevm"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Three people are trees standing tall, the rest are a rolling, tumbling sand dune. Trees: try to hold back the sand dune! How long can you stand tall against the dune?"},"content":{"type":"text","$t":"lowplayers: 6, highplayers: 8, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cyevm"}],"gsx$prompt":{"$t":"Three people are trees standing tall, the rest are a rolling, tumbling sand dune. Trees: try to hold back the sand dune! How long can you stand tall against the dune?"},"gsx$lowplayers":{"$t":"6"},"gsx$highplayers":{"$t":"8"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cztg3"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"You are seeds falling to the ground looking for nutrient-rich soil to sprout in. How might your movements help you dig deeper into the soil? Do you twirl or flutter?"},"content":{"type":"text","$t":"lowplayers: 2, highplayers: 10, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cztg3"}],"gsx$prompt":{"$t":"You are seeds falling to the ground looking for nutrient-rich soil to sprout in. How might your movements help you dig deeper into the soil? Do you twirl or flutter?"},"gsx$lowplayers":{"$t":"2"},"gsx$highplayers":{"$t":"10"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d180g"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Four people form a snow tunnel. The rest are lemmings. An unexpected mid-winter melt is flooding the tunnels you live in. Escape your through your tunnels or risk drowning!"},"content":{"type":"text","$t":"lowplayers: 8, highplayers: 10, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d180g"}],"gsx$prompt":{"$t":"Four people form a snow tunnel. The rest are lemmings. An unexpected mid-winter melt is flooding the tunnels you live in. Escape your through your tunnels or risk drowning!"},"gsx$lowplayers":{"$t":"8"},"gsx$highplayers":{"$t":"10"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d2mkx"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"You are lemmings in the Yukon and an unexpected freeze has left your food stores covered in a layer of ice. Dig, dig them out!"},"content":{"type":"text","$t":"lowplayers: 4, highplayers: 8, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d2mkx"}],"gsx$prompt":{"$t":"You are lemmings in the Yukon and an unexpected freeze has left your food stores covered in a layer of ice. Dig, dig them out!"},"gsx$lowplayers":{"$t":"4"},"gsx$highplayers":{"$t":"8"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cssly"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Band together, and using your bodies, build a seawall around your island town! How high can you make it?"},"content":{"type":"text","$t":"lowplayers: 3, highplayers: 8, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cssly"}],"gsx$prompt":{"$t":"Band together, and using your bodies, build a seawall around your island town! How high can you make it?"},"gsx$lowplayers":{"$t":"3"},"gsx$highplayers":{"$t":"8"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cu76f"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Curl up tightly next to eachother to form a fallen log, providing shelter and moisture to other creatures. One person is a salamander, and the hot, dry weather is too much for you to handle! On hands and knees, wiggle to the log to find your beloved moisture!"},"content":{"type":"text","$t":"lowplayers: 2, highplayers: 4, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cu76f"}],"gsx$prompt":{"$t":"Curl up tightly next to eachother to form a fallen log, providing shelter and moisture to other creatures. One person is a salamander, and the hot, dry weather is too much for you to handle! On hands and knees, wiggle to the log to find your beloved moisture!"},"gsx$lowplayers":{"$t":"2"},"gsx$highplayers":{"$t":"4"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cvlqs"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"All together, lay on the ground in the form of a leaf. What shape will you make to catch the most water when it rains?"},"content":{"type":"text","$t":"lowplayers: 3, highplayers: 6, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cvlqs"}],"gsx$prompt":{"$t":"All together, lay on the ground in the form of a leaf. What shape will you make to catch the most water when it rains?"},"gsx$lowplayers":{"$t":"3"},"gsx$highplayers":{"$t":"6"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cx0b9"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"You are tundra swans flying north to breed, but forest has replaced the tundra where you used to raise your babies. Keep flying! Honk your dismay!"},"content":{"type":"text","$t":"lowplayers: 4, highplayers: 6, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/cx0b9"}],"gsx$prompt":{"$t":"You are tundra swans flying north to breed, but forest has replaced the tundra where you used to raise your babies. Keep flying! Honk your dismay!"},"gsx$lowplayers":{"$t":"4"},"gsx$highplayers":{"$t":"6"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d9ney"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"One person is a caterpillar, inching around. The others are small birds looking for food to feed your babies. Because of a short caterpillar hatch, there's only one left! Will any of you catch it?"},"content":{"type":"text","$t":"lowplayers: 3, highplayers: 5, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d9ney"}],"gsx$prompt":{"$t":"One person is a caterpillar, inching around. The others are small birds looking for food to feed your babies. Because of a short caterpillar hatch, there's only one left! Will any of you catch it?"},"gsx$lowplayers":{"$t":"3"},"gsx$highplayers":{"$t":"5"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/db1zf"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Choose to be a wind turbine or a bat. Bats: swoop to and fro to catch bugs around the turbines without getting hit by their blades!"},"content":{"type":"text","$t":"lowplayers: 5, highplayers: 10, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/db1zf"}],"gsx$prompt":{"$t":"Choose to be a wind turbine or a bat. Bats: swoop to and fro to catch bugs around the turbines without getting hit by their blades!"},"gsx$lowplayers":{"$t":"5"},"gsx$highplayers":{"$t":"10"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dcgjs"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Choose to be a Red Fox or an Arctic Fox. Red Foxes moving northward encounter Arctic Foxes for the first time. Yip and scurry. Are they friends or foes?"},"content":{"type":"text","$t":"lowplayers: 4, highplayers: 8, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dcgjs"}],"gsx$prompt":{"$t":"Choose to be a Red Fox or an Arctic Fox. Red Foxes moving northward encounter Arctic Foxes for the first time. Yip and scurry. Are they friends or foes?"},"gsx$lowplayers":{"$t":"4"},"gsx$highplayers":{"$t":"8"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/ddv49"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"You are a band of armadillos plodding along on hands and knees. Oh no! Danger is near! Roll up in a ball to use your armor as defense!"},"content":{"type":"text","$t":"lowplayers: 4, highplayers: 8, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/ddv49"}],"gsx$prompt":{"$t":"You are a band of armadillos plodding along on hands and knees. Oh no! Danger is near! Roll up in a ball to use your armor as defense!"},"gsx$lowplayers":{"$t":"4"},"gsx$highplayers":{"$t":"8"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d415a"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"You are a group of prairie chickens whose territory has shrunk to almost nothing. But it's mating season, and nothing will stop you! Stomp your feet, bob your head, jump up and down, and make loud booming noises to impress the others. "},"content":{"type":"text","$t":"lowplayers: 4, highplayers: 10, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d415a"}],"gsx$prompt":{"$t":"You are a group of prairie chickens whose territory has shrunk to almost nothing. But it's mating season, and nothing will stop you! Stomp your feet, bob your head, jump up and down, and make loud booming noises to impress the others. "},"gsx$lowplayers":{"$t":"4"},"gsx$highplayers":{"$t":"10"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d5fpr"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"All together, form one big leaf with your bodies. Warming air prompts the leaf to sweat. Release your droplets into the air!"},"content":{"type":"text","$t":"lowplayers: 3, highplayers: 6, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d5fpr"}],"gsx$prompt":{"$t":"All together, form one big leaf with your bodies. Warming air prompts the leaf to sweat. Release your droplets into the air!"},"gsx$lowplayers":{"$t":"3"},"gsx$highplayers":{"$t":"6"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d6ua4"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"The fairy possums' forest is shrinking due to wildfires and logging. Band together as tiny possums, and leap as far as you can to find a new forest home!"},"content":{"type":"text","$t":"lowplayers: 3, highplayers: 7, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d6ua4"}],"gsx$prompt":{"$t":"The fairy possums' forest is shrinking due to wildfires and logging. Band together as tiny possums, and leap as far as you can to find a new forest home!"},"gsx$lowplayers":{"$t":"3"},"gsx$highplayers":{"$t":"7"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d88ul"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Form a Carbon Dioxide molecule: one person is Carbon and two are Oxygen molecules. Carbon, hold hands with each Oxygen to form a bond, then rise into the atmosphere."},"content":{"type":"text","$t":"lowplayers: 3, highplayers: 3, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/d88ul"}],"gsx$prompt":{"$t":"Form a Carbon Dioxide molecule: one person is Carbon and two are Oxygen molecules. Carbon, hold hands with each Oxygen to form a bond, then rise into the atmosphere."},"gsx$lowplayers":{"$t":"3"},"gsx$highplayers":{"$t":"3"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dkvya"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Everyone: Be a cloud of mosquitos growing over time. Choose one person to be the first mosquito, then tag others until the entire audience is buzzing!"},"content":{"type":"text","$t":"lowplayers: all, highplayers: all, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dkvya"}],"gsx$prompt":{"$t":"Everyone: Be a cloud of mosquitos growing over time. Choose one person to be the first mosquito, then tag others until the entire audience is buzzing!"},"gsx$lowplayers":{"$t":"all"},"gsx$highplayers":{"$t":"all"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dmair"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Form a Nitrous Oxide molecule: one person is Oxygen and the other 2 are Nitrogen. Nitrogen hold hands with eachother, one nitrogen holding hands with Oxygen. Rise into the atmosphere!"},"content":{"type":"text","$t":"lowplayers: 3, highplayers: 3, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dmair"}],"gsx$prompt":{"$t":"Form a Nitrous Oxide molecule: one person is Oxygen and the other 2 are Nitrogen. Nitrogen hold hands with eachother, one nitrogen holding hands with Oxygen. Rise into the atmosphere!"},"gsx$lowplayers":{"$t":"3"},"gsx$highplayers":{"$t":"3"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dnp34"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Form a Methane Molecule: one person is Carbon and 4 others are Hydrogen. Each Hydrogen holds a hand or leg of the Carbon. Rise into the atmosphere!"},"content":{"type":"text","$t":"lowplayers: 5, highplayers: 5, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dnp34"}],"gsx$prompt":{"$t":"Form a Methane Molecule: one person is Carbon and 4 others are Hydrogen. Each Hydrogen holds a hand or leg of the Carbon. Rise into the atmosphere!"},"gsx$lowplayers":{"$t":"5"},"gsx$highplayers":{"$t":"5"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dp3nl"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Embody the Earth's 7 major tetonic plates: Pacific Plate, North American Plate, Eurasian Plate, African Plate, Antarctic Plate, Indo-Australian Plate, South American Plate. Each person become a plate: drift apart and together!"},"content":{"type":"text","$t":"lowplayers: 7, highplayers: 7, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dp3nl"}],"gsx$prompt":{"$t":"Embody the Earth's 7 major tetonic plates: Pacific Plate, North American Plate, Eurasian Plate, African Plate, Antarctic Plate, Indo-Australian Plate, South American Plate. Each person become a plate: drift apart and together!"},"gsx$lowplayers":{"$t":"7"},"gsx$highplayers":{"$t":"7"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/df9om"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Lemmings push north as the tundra warms, where they run into some snowy owls. Can the owls catch all the lemmings? Owls, hoot! Lemmings, squeak!"},"content":{"type":"text","$t":"lowplayers: 4, highplayers: 10, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/df9om"}],"gsx$prompt":{"$t":"Lemmings push north as the tundra warms, where they run into some snowy owls. Can the owls catch all the lemmings? Owls, hoot! Lemmings, squeak!"},"gsx$lowplayers":{"$t":"4"},"gsx$highplayers":{"$t":"10"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dgo93"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Form a hollow tube with your bodies for a burrowing owl to live in! One person, be a Burrowing Owls looking for a new home. Is this one to your liking? Shriek and hoot to show how you feel about it!"},"content":{"type":"text","$t":"lowplayers: 5, highplayers: 10, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/dgo93"}],"gsx$prompt":{"$t":"Form a hollow tube with your bodies for a burrowing owl to live in! One person, be a Burrowing Owls looking for a new home. Is this one to your liking? Shriek and hoot to show how you feel about it!"},"gsx$lowplayers":{"$t":"5"},"gsx$highplayers":{"$t":"10"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}},{"id":{"$t":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/di2tg"},"updated":{"$t":"2017-06-10T07:22:43.790Z"},"category":[{"scheme":"http://schemas.google.com/spreadsheets/2006","term":"http://schemas.google.com/spreadsheets/2006#list"}],"title":{"type":"text","$t":"Form a long, hollow burrow together. A troupe of burrowing owls follow their leader through the burrow. How far can they go? What sounds to they make?"},"content":{"type":"text","$t":"lowplayers: 5, highplayers: 10, time: 30000"},"link":[{"rel":"self","type":"application/atom+xml","href":"https://spreadsheets.google.com/feeds/list/1SojNwKJj8V0vas9-3jM-ji9UjUa4gMi45ZtOmoofDUM/3/public/full/di2tg"}],"gsx$prompt":{"$t":"Form a long, hollow burrow together. A troupe of burrowing owls follow their leader through the burrow. How far can they go? What sounds to they make?"},"gsx$lowplayers":{"$t":"5"},"gsx$highplayers":{"$t":"10"},"gsx$time":{"$t":"30000"},"gsx$notes":{"$t":""}}]}}


var searchResults;




function search(array, key, prop){
    // Optional, but fallback to key['name'] if not selected
    prop = (typeof prop === 'undefined') ? 'name' : prop;
    var tempArray = [];
    for (var i=0; i < array.length; i++) {
        // console.log(array[i][prop]);
        //if (array[i][prop] <= Maxkey && array[i][prop] >= minkey) {
        if (array[i][prop] <= key) {
            tempArray.push(array[i]);
        } else if(array[i][prop] == 'all'){
            tempArray.push(array[i]);
        }
    }
    return tempArray;
}

var allTasks = []


function moreDetails(click){
     var $this = null;
     // check if object is jquery object
     if(click instanceof jQuery){
          $this = click;
     } else {
          // this is a javascript object
          $this = $('#'+click.id);
     }
     var href = $this.attr("href");
     var hash = href.substr(1);

     if($this.hasClass('artwork')){
          showArtworkClose();

          console.log('artwork');

          // Get project desc panel and send it to marker as visited function
          var $thisProject = $this.parents('.project-slide-panel');
          //setMarkerAsVisited($thisProject);


          //console.log($this.attr('data-project-url'));
          var projectUrl = $this.attr('data-project-url');
          var $iframe = $('.iframe.project-slide-panel');
          //customProblemsAndFixesArtwork($('.slideUp.project-slide-panel'));

          //Set Panel from display none to display block
          $iframe.css('display','block');

          //Set Panel src
          $iframe.attr('src',projectUrl);

          //If we don't set a slight timeout the css animation won't work.
          setTimeout(function(){
            $iframe.addClass('slideUp');
          },100);

        }  else {

                    //Set Panel from display none to display block
                    $('.page.'+hash).css('display','block');

                    //If we don't set a slight timeout the css animation won't work.
                    setTimeout(function(){
                         $('.page.'+hash).addClass('slideUp');
                    },100);

                    var currentPageImage = $('.project-slide-panel.'+hash).find('.location-image-large');
                    var currentPage = $('.project-slide-panel.'+hash);
                    var currentImage = currentPage.attr('data-image')
                   if(currentPageImage.length){
                     $('<img/>').attr('src', '/assets/images/locations/'+currentImage+'-large.jpg').load(function() {
                      $(this).remove(); // prevent memory leaks as @benweet suggested
                      currentPageImage.css('background-image', 'url(/assets/images/locations/'+currentImage+'-large.jpg)');
                      currentPageImage.delay(700).velocity({opacity: 1},600);
                     });
                   }

           }
}

function slideDownPanel(link){
     var $this = link;

     if($this.hasClass('artwork')){
          var $iframe = $('.iframe.project-slide-panel');
          hideArtworkClose();

          $iframe.velocity({opacity: 0}, 150, function(){

            setTimeout(function(){
              $iframe.css('display','none');
              $iframe.attr('src', $iframe.attr('data-fake-src'));
              $iframe.removeClass('slideUp');

              setTimeout(function(){
                $iframe.removeClass('white'); // This is a fix for some of the projects
                $('.close.artwork').removeClass('black'); // This is a fix for some of the projects
                $iframe.css('opacity','1');
              },1);

            }, 1);



          });


        } else {
     if($this.parent('.nav').parent('.page').hasClass('sign-up')){
          $('#carousel-sign-up').carousel(0);
     }
     $this.parent('.nav').parent('.page').removeClass('slideUp');
     setTimeout(function(){
       $this.parent('.nav').parent('.page').css('display','none');
     }, 750);

     }
}

/**********************
Globals
**********************/
if(SETTINGS.server == 'localhost'){
    socket = io('http://localhost:3000');
} else if(SETTINGS.server == 'server-http'){
    //console.log = function() {}
    socket = io('http://joincollectiveaction.com:3000');
} else if(SETTINGS.server == 'server-https'){
   //console.log = function() {}
   socket = io('https://joincollectiveaction.com:3000', { secure : true});
}

//var socket = io('http://localhost:3000'); //MAKE SSURE TO CHANGE THIS TO THE SERVER'S IP LATER!
//var socket = io('https://joincollectiveaction.com:3000', { secure : true}); //MAKE SSURE TO CHANGE THIS TO THE SERVER'S IP LATER!


//reload the view when the app boots up & this page connects


// var time;

// const GAME_LOCATION = 'location1' ///////////IMPORTANT ***** SET GAME LOCATION IN game-projection.hbs

/**********************
Helper Functions
**********************/
function getRandomInt(min, max) {
  min = Math.ceil(min);
  max = Math.floor(max);
  return Math.floor(Math.random() * (max - min)) + min;
}



var gameProjection = {
     bodyElement: $('body'),
     currentNumberOfConnections:100,
     requestedNumberOfConnections: false,
     currentPlayers:null,
     requestedCurrentPlayers: 100,
     currentTask:null,

     requestedTask: false,
     prepFrameCounter:0,
     taskFrameCounter:0,
     numberOfTimesGetDataHasRun: 0,
     wait:15000,
     state:'title',
     gameStateIndex:0,

     // Time Variables
     TimeTitle: 15000,
     TimeHighscoresPlayers:10000,
     TimeHighscoresTeams:10000,
     TimeGetNumberOfConnectionsTaskPlayers:500,
     TimeSetupGame:500,
     TimeInviteToPerformanceArea: 5000,
     TimeWeNeedMorePlayers: 5000,
     TimePrepForTask: 15000,
     TimeStartTask: 30000,
     TimeEndTask: 8000,
     TimeEndScore: 7000,
     TimeReset: 250,
     avatarLimit:100,
     taskPlayedCounter: 1,
     //gameStates:['highscore players','highscore team','teaser','get players','get task','start task'],
     init: function(){
          //gameProjection.addLocationClassToBody();

           $('#movie-intro').get(0).play()

          time = new Date().getTime();//store the current time
          // this.getNewTask();
          // this.newGame()

          // socket.on('connect', function(){
          //     console.log('connected to the server as: ' + socket.id);
          //
          //     socket.emit('joinProjectinoRoom', GAME_LOCATION) //join my own room!
          //
          //     //reset state on page refresh / re-connect of game-projection
          //     socket.emit('resetRoomClients', GAME_LOCATION);
          //
          //     setTimeout(function(){ // This is here for a weird problem for when the projections crashes and you need to reload the page this is here to make sure it gets the already connected users.
          //       socket.emit('getAllUsers',GAME_LOCATION, function(users){
          //           users.forEach(function(user){
          //             if(avatars.length >= gameProjection.avatarLimit){
          //               return;
          //             } else {
          //               var a = new avatar('assets/images/avatarsHalfSize/'+user.userObject.avatar+'', user.id, random(0,width),random(0,height))
          //               avatars.push(a)
          //             }
          //           })
          //
          //       })
          //     },1500);
          // });

          //gameProjection.parseTitleUrlParamater();
          //socket.on('disconnect', function(){
          //     console.log('disconnected from the server as: ' + socket.id);
          //});

         //socket.on('addAvatar',function(user){
         //  console.log('addAvatar',user);
         //  if(avatars.length >= gameProjection.avatarLimit){
         //    return;
         //  } else {
         //    var a = new avatar('assets/images/avatarsHalfSize/'+user.userObject.avatar+'', user.id, random(0,width),random(0,height))
         //    avatars.push(a)
         //  }
         //})
         //socket.on('removeAvatar',function(user){
         //  console.log('removeAvatar',user);

         //  for (var i = 0; i < avatars.length; i++) {

         //     if(avatars[i].id == user.id){
         //       avatars[i].state = 'avatarIsShrinking';
         //       avatars[i].startTime = performance.now();
         //       avatars[i].endTime = avatars[i].startTime + duration2;
         //       soundReverse.playbackRate = random(.8,1.5);
         //       soundReverse.play();
         //     }
         //  }

         //})

     },
     addLocationClassToBody:function(){
      $('body').addClass(GAME_LOCATION);
     },
     parseTitleUrlParamater:function(){
      var title = $('.location-title').text();
      var titleElement = $('.location-title')
      var titleIcon = $('.location-icon')
      var urlForIcons = 'assets/images/projections/location-icons/'
      switch (title) {
        case 'commons':
            titleIcon.attr('src',urlForIcons+'icon_commons.png');
            titleElement.html('Commons');
            break;
        case 'westbank':
            titleIcon.attr('src',urlForIcons+'icon_cedarriverside.png');
            titleElement.html('Westbank');
            break;
        case 'littleafrica':
            titleIcon.attr('src',urlForIcons+'icon_littleafrica.png');
            titleElement.html('Little Africa');
            break;
        case 'rondo':
            titleIcon.attr('src',urlForIcons+'icon_rondo.png');
            titleElement.html('Rondo');
            break;
        case 'littlemekong':
            titleIcon.attr('src',urlForIcons+'icon_littlemekong.png');
            titleElement.html('Little Mekong');
            break;
        case 'lowertown':
            titleIcon.attr('src',urlForIcons+'icon_lowertown.png');
            titleElement.html('Lowertown');
            break;
      }
     },
     changeState:function(string){
      gameProjection.state = string;
     },
     setStateAndTime:function(state, waitTime){
      var self = this;
      console.log(state);
      if(state != 'get-number-of-connections-task-players' && state != 'get-number-of-connections' && state != 'get-task' && state != 'get-players'){
        slideDownPanel($('.page.slideUp .close'));
        moreDetails($('.page.'+state+' .nav a'));
      }
      if($('body').hasClass('warning')){
        $('body').removeClass('warning');
      }
      self.state = state;
      self.wait = waitTime
     },
     removeBodyClassForAnimatedBackground:function(){
      var self = this;
      if(self.bodyElement.hasClass('warning')){
        self.bodyElement.removeClass('warning');
      }
     },
     animateBackgroundForLowTime:function(){
      var self = this;
      var prepTime = Math.floor(self.TimePrepForTask/1000 - (self.prepFrameCounter/60));
      var taskTime = Math.floor(self.TimeStartTask/1000 - (self.taskFrameCounter/60));

      if(taskTime < 10 && self.state == 'start-task'){
        self.bodyElement.addClass('warning');
      } else if(prepTime < 10 && self.state == 'prep-for-task'){
        self.bodyElement.addClass('warning');
      }
     },
     reset:function(){
      var self = this;
      //self.currentNumberOfConnections = null;
      //self.requestedNumberOfConnections = false;
      //self.currentPlayers = null;
      //self.requestedCurrentPlayers = false;
      //self.currentTask = null;
      //self.requestedTask = false;

      self.prepFrameCounter = 0;
      self.taskFrameCounter = 0;
      console.log('reset');
      //self.numberOfTimesGetDataHasRun = 0;
      self.taskPlayedCounter;
     },
     writeInvitionToScreen:function(){
        var textBox = $('.invite-to-performance-area .container .inner-container p');
        var self = this;
        var text = 'Players: Come on up!'
        if(self.currentTask.playersMax == 'all'){
          text = 'Everyone: Get Ready!'
        }
        textBox.html(text);
     },
      checkTimer:function(){
           var self = this;
           if(new Date().getTime() - time >= self.wait) {
                console.log("tick2");//if it is, do something
                time = new Date().getTime();//also update the stored time
                switch (self.state) {
                  case 'title':
                      self.hideIntroVideo();
                      self.getTask();
                      self.setStateAndTime('setup-game', self.TimeSetupGame); // OFFLINE MODE
                      //self.setStateAndTime('highscores-players', self.TimeHighscoresPlayers);
                      self.writeHighScoresToScreen();

                      // self.refreshConnectedBackgroundAvatars();
                      break;
                  case 'highscores-players':

                      //self.setStateAndTime('highscores-teams', self.TimeHighscoresTeams);
                      self.writeTeamScoresToScreen()
                      break;
                  case 'highscores-teams':
                      self.setStateAndTime('get-number-of-connections-task-players', self.TimeGetNumberOfConnectionsTaskPlayers);
                      break;
                  case 'get-number-of-connections-task-players':
                      self.checkIfNumberOfConnectionsIsEmptyAndGet();
                      self.checkIfTaskIsEmptyAndGet();
                      self.checkIfPlayersIsEmptyAndGet();
                      if(self.currentNumberOfConnections != null && self.currentTask != null && self.currentPlayers != null && allTasks.length > 0){
                        self.setStateAndTime('setup-game', self.TimeSetupGame);
                      } else if(self.currentNumberOfConnections <= 1 && self.currentTask != null && self.currentPlayers <= 1 && allTasks.length > 0){
                        console.log('333!!!!!!!!!!!!!!!!!!!!!')
                        self.setStateAndTime('title', self.TimeTitle);
                        self.playerIntroVideo();
                      } else if(self.numberOfTimesGetDataHasRun > 15) {
                        //console.log('444!!!!!!!!!!!!!!!!!!!!!')

                        self.setStateAndTime('title', self.TimeTitle);
                        self.playerIntroVideo();
                        self.reset();
                        self.numberOfTimesGetDataHasRun = 0; // Maybe this should be self.reset();
                      } else {
                        self.setStateAndTime('get-number-of-connections-task-players', 100);
                        self.numberOfTimesGetDataHasRun++;
                      }
                      break;
                  case 'setup-game':
                      // self.newGame();
                      self.writeTaskToScreen();
                      self.writeInvitionToScreen();
                      $('#sound-call-people')[0].play();
                      self.setStateAndTime('invite-to-performance-area', self.TimeInviteToPerformanceArea);
                      break;
                  case 'invite-to-performance-area':
                      //check to change the screen to wait for more players if there are less than 2.
                      if(self.currentNumberOfConnections < 2) {
                        self.setStateAndTime('we-need-more-players', self.TimeWeNeedMorePlayers);
                      } else {
                        self.setStateAndTime('prep-for-task', self.TimePrepForTask);
                        $('#sound-get-ready')[0].play();
                      }
                      //var interval = 0;
                      //self.setStateAndTime('get-players', self.wait);
                      //$('.page .people ul li').each(function(){
                      //  interval = interval + 2000;
                      //  $(this).delay(interval).animate({opacity:1});
                      //});
                      break;
                  case 'we-need-more-players':
                      self.setStateAndTime('get-number-of-connections-task-players', self.TimeGetNumberOfConnectionsTaskPlayers);
                      break;
                  case 'prep-for-task':
                      // time to get ready
                      console.log(gameProjection.currentPlayers)
                      self.setStateAndTime('start-task',  self.TimeStartTask);
                      self.removeBodyClassForAnimatedBackground();
                      $('#sound-start')[0].play();
                      //self.setStateAndTime('start-task',  gameProjection.currentTask.time);
                      break;
                  case 'start-task':
                      self.setStateAndTime('end-task', self.TimeEndTask);
                      self.removeBodyClassForAnimatedBackground();
                      //$('#sound-cheers')[0].play();
                      $('#movie-great-job').get(0).play()
                      break;
                  case 'end-task':
                      //self.setStateAndTime('end-score', self.TimeEndScore);
                      self.setStateAndTime('reset', self.TimeReset);
                      break;
                  case 'end-score':
                      //self.setStateAndTime('reset', self.TimeReset);
                      break;
                  case 'reset':
                      //socket.emit('resetViews', self.currentPlayers)
                      self.reset();
                      if(gameProjection.taskPlayedCounter >= 5){
                        self.setStateAndTime('title', self.TimeTitle);
                        self.playerIntroVideo();
                        gameProjection.taskPlayedCounter = 1;
                      } else {
                      	self.getTask();
                        self.setStateAndTime('setup-game', self.TimeSetupGame);
                        gameProjection.taskPlayedCounter++
                      }


                      break;
                }
                //self.state = self.gameStates[self.gameStateIndex % 5];
                //self.gameStateIndex++;
                //gameProjection.getNewTask();
           }
      },
      hideIntroVideo:function(){
        $('#movie-intro').css('display','none');
      },
      playerIntroVideo:function(){
        $('#movie-intro').css('display','block');
        $('#movie-intro').get(0).play();
      },
      draw:function(){
          var self = gameProjection;
          requestAnimationFrame(self.draw);
          switch (self.state) {
            case 'title':
                console.log('title');
                console.log();
                //if($('#movie-intro').get(0).currentTime > 15){
                //
                //
                //}
                self.checkTimer();
                //slideDownPanel($('.page.sign-up .close'));
                break;
            case 'highscores-players':
                console.log('highscores-players');
                self.checkTimer();
                break;
            case 'highscores-teams':
                console.log('highscore team');
                self.checkTimer();
                break;
            case 'get-number-of-connections-task-players':
                console.log('get-number-of-connections-task-players');
                self.checkTimer();
                break;
            case 'setup-game':
                console.log('get-players');
                self.checkTimer();
                break;
            case 'invite-to-performance-area':
                console.log('invite-to-performance-area');
                self.checkTimer();
                break;
            case 'we-need-more-players':
                console.log('we-need-more-players');
                self.checkTimer();
                break;
            case 'prep-for-task':
                console.log('prep for task');
                self.writePrepTimeToScreen();
                self.animateBackgroundForLowTime();
                self.checkTimer();
                break;
            case 'start-task':
                // time to get ready
                console.log('start task');
                self.writeTaskTimeToScreen();
                self.animateBackgroundForLowTime();
                self.checkTimer();
                break;
            case 'end-task':
                console.log('end task');
                self.checkTimer();
                break;
            case 'end-score':
                console.log('end score');
                self.checkTimer();
                break;
            case 'reset':
                console.log('reset task');
                self.checkTimer();
                break;
          }


     },

    checkIfNumberOfConnectionsIsEmptyAndGet:function(){
      var self = gameProjection;
      if (self.requestedNumberOfConnections == false){
        self.requestedNumberOfConnections = true;
        self.checkNumberOfConnections();
      }
    },
    checkNumberOfConnections:function(){
        gameProjection.currentNumberOfConnections = Math.ceil(Math.random()*10); // OFFLINE MODE
    },
    checkIfPlayersIsEmptyAndGet:function(){
      var self = gameProjection;
      if (self.requestedCurrentPlayers == false && self.currentTask != null){
        self.requestedCurrentPlayers = true;
        self.getPlayers();
      }
    },
    getPlayers:function(){
      //gameProjection.currentTask.location = GAME_LOCATION;
      //socket.emit('getNewAndNotifyUsers', gameProjection.currentTask, function(chosenPlayers){
      //  console.log(chosenPlayers);
      //  gameProjection.currentPlayers = chosenPlayers;
      //}); // close getNewAndNotifyUsers
    },
    checkIfTaskIsEmptyAndGet:function(){
      var self = gameProjection;
      if (self.requestedTask == false && self.currentNumberOfConnections != null){
        self.requestedTask = true;
        self.getTask();
      }
    },
    getTask:function(){
      var numberOfPlayers = gameProjection.currentNumberOfConnections;
      searchResults = null;
      if(gameProjection.currentNumberOfConnections < 2){
        console.log('less then 2 ')
        // This need to be changed not to grab specific number of connections but only task that have a minimum number of connections
        searchResults = [];
      } else {
        console.log('more then 2 ')

        searchResults = search(allTasks, gameProjection.currentNumberOfConnections,'playersMin')
        //searchResults = allTasks[getRandomInt(0,allTasks.length)];
      }
      // console.log(ameProjection.currentTask.time);
      gameProjection.currentTask = searchResults[getRandomInt(0,searchResults.length)];
      console.log(gameProjection.currentTask.time);
      gameProjection.TimeStartTask = parseInt(gameProjection.currentTask.time);
      console.log(gameProjection.TimeStartTask);
    },
    writeTaskToScreen:function(){
      var task = gameProjection.currentTask.task;
      $('.currentTask').html(task);
    },
    writePrepTimeToScreen:function(){
      var self = this;
      self.prepFrameCounter++;
      var prepTime = Math.floor(self.TimePrepForTask/1000 - (self.prepFrameCounter/60));
      $('.prep-time').html(prepTime);
    },
    writeTaskTimeToScreen:function(){
      var self = this;
      self.taskFrameCounter++;
      var taskTime = Math.floor(self.TimeStartTask/1000 - (self.taskFrameCounter/60));
      $('.task-time').html(taskTime);
    },
    setupDebugTimes:function(){
        var self = this;
        self.TimeTitle = 1000;
        self.TimeHighscoresPlayers = 1000;
        self.TimeHighscoresTeams = 1000;
        self.TimeGetNumberOfConnectionsTaskPlayers = 500;
        self.TimeSetupGame = 500;
        self.TimeInviteToPerformanceArea = 3000;
        self.TimeWeNeedMorePlayers = 3000;
        self.TimePrepForTask = 3000;
        self.TimeStartTask = 5000;
        self.TimeEndTask = 8000;
        self.TimeEndScore = 1000;
        self.TimeReset = 250;
    },
    setupDebugPrompts(){
      var numberOfPlayers = gameProjection.currentNumberOfConnections;
      searchResults = null;
      searchResults = search(allTasks, 999,'playersMin')
      var currentTaskIndex = 0;

      gameProjection.setStateAndTime('start-task',  99999999999999);
      // console.log(ameProjection.currentTask.time);
      setInterval(function(){
        gameProjection.currentTask = searchResults[currentTaskIndex];
        gameProjection.writeTaskToScreen();
        currentTaskIndex++;
      }, 1500);
    },
    writeHighScoresToScreen:function(){
      socket.emit('getHighScoreUsers',function(results){
        console.log('highScores',results);
        var appendData = ''
        results.forEach(function(result){
          appendData += '<div><div style="float:left;width:50px;height:50px;background-image:url(assets/images/avatarsHalfSize/'+ result.avatar +');background-repeat:no-repeat;background-position:center center;background-size:contain;" ></div><p class="align-left" >' + result.userName + '</p><p class="align-right">' + result.score + '</p><div style="clear:both"></div></div>';
        })
        // console.log(appendData);
        $('.scoreBoard').html(appendData)
      })
    },
    writeTeamScoresToScreen:function(){
      socket.emit('getTeamScores',function(results){
        // console.log(results);

        results.sort(function(a, b) {
            return b.score - a.score
        })
        // console.log('',results);

        var appendData = ''
        results.forEach(function(result){
          var teamString =''
          if(result.team == 1){
              teamString = '<div style="color:#4baaf8"><p class="align-left" ><img style="height:50px;margin-top:-8px;" src="assets/images/teamicons/1.png"> Water</p> '
          }else if(result.team == 2){
              teamString = '<div style="color:#8e98f8"><p class="align-left" ><img style="height:50px;margin-top:-8px;" src="assets/images/teamicons/2.png"> Air</p> '
          }else if(result.team == 3){
            teamString = '<div style="color:#97c355"><p class="align-left" ><img style="height:50px;margin-top:-8px;" src="assets/images/teamicons/3.png"> Earth</p> '
          }else if(result.team == 4){
            teamString = '<div style="color:#e88f3d"><p class="align-left" ><img style="height:50px;margin-top:-8px;" src="assets/images/teamicons/4.png"> Fire</p> '
          }

          appendData += teamString+'<p class="align-right">' + result.score + '</p><div style="clear:both"></div></div>'
        })

        $('.teamScoreBoard').html(appendData)

      })
    },
    // refreshConnectedBackgroundAvatars:function(){
    //   socket.emit('getAllUsers', GAME_LOCATION, function(connectedUsers) {
    //     console.log('gau',connectedUsers);
    //     compiledAvatars = ''
    //     connectedUsers.forEach(function(user){
    //       //compiledAvatars+= '<img src="assets/images/avatars/'+  +'">'
    //         var id = user.userObject.id;
    //         if(avatars.filter(function(e) { return e.id == id }).length > 0){
    //           // Do nothing
    //         } else {
    //           var a = new avatar('assets/images/avatars/'+user.userObject.avatar+'',user.userObject.id, random(0,width),random(0,height),  )
    //           avatars.push(a)
    //         }
    //     })
    //     //$('.tempAvatarStorage').html(compiledAvatars)
    //   }); // close getNewAndNotifyUsers
    // },
    convertSpreadsheetToTasksObject:function(json){
        //https://stackoverflow.com/questions/30082277/accessing-a-new-style-public-google-sheet-as-json
        console.log('parsing Google Spreadsheet');
        //console.log(json);

        for (var i = 0; i < json.feed.entry.length; i++) {
          //  This is console.log for the each row in the spreadsheet
          //console.log( json.feed.entry[i]);
          var task = json.feed.entry[i].gsx$prompt.$t;
          var timePrep =  5000;//json.feed.entry[i].gsx$bio.$t;
          var timePlay =  30000;//json.feed.entry[i].gsx$bio.$t;
          var time = json.feed.entry[i].gsx$time.$t;
          var players = json.feed.entry[i].gsx$highplayers.$t;
          var playersMax = json.feed.entry[i].gsx$highplayers.$t;


          //var time;//10000;//json.feed.entry[i].gsx$bio.$t;
          // if(json.feed.entry[i].gsx$time.$t == ''){
          //  time = '2';
          //} else {
          //  playersMin = json.feed.entry[i].gsx$time.$t;
          //}


          var playersMin;
          if(json.feed.entry[i].gsx$lowplayers.$t == ''){
            playersMin = '2';
          } else {
            playersMin = json.feed.entry[i].gsx$lowplayers.$t;
          }

          console.log(playersMin);

          //Object
          var tempObject = {
            task: task.replace(/^\s+|\s+$/g, ""),
            timePrep: timePrep,
            timePlay: timePlay,
            time: time.replace(/^\s+|\s+$/g, ""),
            players: players.replace(/^\s+|\s+$/g, ""),
            playersMin: playersMin.replace(/^\s+|\s+$/g, ""),
            playersMax: playersMax.replace(/^\s+|\s+$/g, "")

          }

          // Make a newly formatted Master List/Array
          // of all of the projects
          allTasks.push(tempObject);

        //marker.setVisible(true);
        }
        console.log('parsed Google Spreadsheet');


    }
}


/*******************
     Setup
********************/
$(document).ready(function(){ //somethimes this fires twice for whatever reason...
  console.log('load');
  gameProjection.convertSpreadsheetToTasksObject(json);
  gameProjection.init();
  //gameProjection.setupDebugTimes();
  //gameProjection.setupDebugPrompts();
  gameProjection.draw()
});




function backgroundDecoration(path){
  this.image = loadImage(path)
  this.x = getThird()
  this.y = random(height)
  this.sz = random(75,100)
  this.speed = random(0.1,0.5)

  this.display = function(){
    image(this.image,this.x,this.y,this.sz,this.sz)
    this.y += this.speed
    if(this.y > height){
      this.y = -this.sz
      this.x = getThird()
    }
  }

}

function getThird(){
  var location
  if(random(1)> 0.5){
    location = random(0, width/3-75)
  }else{
    location = random(width/3*2, width-75)
  }
  return location;
}

/*******************
  ANIMATED BACKGROUND
********************/
var avatars = []
var decorations = []
// var count = 0
// var cell = 200
// var numAvatars = 30
// var positions = []
var sound;
var soundReverse;
function preload(){
  sound = loadSound('assets/audio/pop.mp3');
  soundReverse = loadSound('assets/audio/popReverse.mp3');
}

function setup() {
  pixelDensity(1);


  createCanvas(windowWidth,windowHeight)
  //for (var i = 0; i < 30; i++) {
    // var a = loadImage('avatars/'+ Math.ceil(Math.random()*294)+'.png')
  //}

  for (var i = 1; i <= 8; i++) {
    d = new backgroundDecoration('../assets/images/projection-decoration/'+ GAME_LOCATION +'/' + i + '.png')
    decorations.push(d)
  }

  for (var i = 1; i <= 20; i++) {

  var a = new avatar('../assets/images/avatarsHalfSize/'+ceil(random(1,300))+'.png', 88888888, random(0,width),random(0,height))
  avatars.push(a)
  }


}

function draw() {
  background(255)

  for (var i = 0; i < decorations.length; i++) {
    decorations[i].display()
  }


  avatars.sort(function(a, b) {
    return (a.y-a.avatarHeight) - (b.y-a.avatarHeight)
  })

  for (var i = 0; i < avatars.length; i++) {
    avatars[i].display();
    if(avatars[i].readyRemove == true){avatars.splice(i, 1); }
  }


}
function collidePointRect (pointX, pointY, x, y, xW, yW) {
//2d
if (pointX >= x &&         // right of the left edge AND
    pointX <= x + xW &&    // left of the right edge AND
    pointY >= y &&         // below the top AND
    pointY <= y + yW) {    // above the bottom
        return true;
}
return false;
};

function perlin() {
  let i = 0;
  let n = random(100);
  return ()=>{
    n += 0.0004;

    //i = (i + 1) % 2;

    let noiseT = i + n;
    //noiseT = noiseT % 1.0;
    var ret = noise(noiseT); //(0,1)
    //ret = (ret - .5) * 2; //(-1,1)
    //console.log(ret)
    return ret;
  }
}
function easeOutBounce(t, b, c, d) {
    if ((t /= d) < (1 / 2.75)) {
        return c * (7.5625 * t * t) + b;
    } else if (t < (2 / 2.75)) {
        return c * (7.5625 * (t -= (1.5 / 2.75)) * t + .75) + b;
    } else if (t < (2.5 / 2.75)) {
        return c * (7.5625 * (t -= (2.25 / 2.75)) * t + .9375) + b;
    } else {
        return c * (7.5625 * (t -= (2.625 / 2.75)) * t + .984375) + b;
    }
}

function easeInOutElastic(t, b, c, d) {
    var a, p, s;
    s = 1.70158;
    p = 0;
    a = c;
    if (t === 0) {
      b;
    } else if ((t /= d / 2) === 2) {
      b + c;
    }
    if (!p) {
      p = d * (0.3 * 1.5);
    }
    if (a < Math.abs(c)) {
      a = c;
      s = p / 4;
    } else {
      s = p / (2 * Math.PI) * Math.asin(c / a);
    }
    if (t < 1) {
      return -0.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;
    } else {
      return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p) * 0.5 + c + b;
    }
  }


  function easeInElastic(t, b, c, d) {
    var a, p, s;
    s = 1.70158;
    p = 0;
    a = c;
    if (t === 0) {
      b;
    } else if ((t /= d) === 1) {
      b + c;
    }
    if (!p) {
      p = d * 0.3;
    }
    if (a < Math.abs(c)) {
      a = c;
      s = p / 4;
    } else {
      s = p / (2 * Math.PI) * Math.asin(c / a);
    }
    return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;
  }
var startTime
var duration = 300; // animate over 1000ms
var duration2 = 700; // animate over 1000ms

var totChange = .99; // change the size by 25%


function avatar(path,id,x,y){
  this.id = id;
  this.x = x
  this.y = y
  this.previousX = 0;
  this.previousY = 0;
  this.random = perlin()
  this.yRandom = perlin()
  this.image = loadImage(path)
  this.speed = random(0,6)
  this.waitTime = random(4,10)
  this.counter = 0;
  this.state = 'avatarIsGrowing';
  this.avatarWidth = -2;
  this.avatarHeight = 0;
  this.startTime = performance.now();
  this.endTime = this.startTime + duration;
  this.rotate = 0;
  this.angle = 0;
  this.angleCounter = 0;
  this.currentValue = 0;
  this.readyRemove = false;
  this.avatarSetup = true;

  sound.playbackRate = random(.8,1.5);
  sound.play();

  this.avatarGrow = function(){
    if (this.time >= this.endTime)
    {
      this.state = 'avatarIsWalking';
    }

    var elapsed =  this.time - this.startTime;
    var value = easeOutBounce(elapsed, .001, totChange, duration);

    if(value > .99){ value = 0.99; } // This is required from keep the tween from increasing too far
    this.currentValue =value; // this is needed to reverse the tween.

    this.avatarWidth = (this.image.width) * value/3;
    this.avatarHeight = (this.image.height) * value/3;//
  },
  this.avatarShrink = function(){
    if (this.time >= this.endTime)
    {
      this.state = 'avatarIsWalking';
      this.readyRemove = true;
    }

    var elapsed =  this.time - this.startTime;
    var value = easeInOutElastic(elapsed, this.currentValue, -this.currentValue, duration2);

    if(value < 0){ value = 0.000001; } // This is required from keep the tween from reversing too far

    this.avatarWidth = (this.image.width) * (value/3);
    this.avatarHeight = (this.image.height) * (value/3);//
  },
  this.calculateSpeed = function(){
      this.speed = abs(this.x - this.previousX) + abs(this.y - this.previousY);
      //speed = speed;
      //console.log(speed);
      this.previousX = this.x;
      this.previousY = this.y;
  },
  this.display = function(){
    console.log()

    this.time = performance.now();

    while (this.avatarSetup){
      this.x = constrain( map(this.random(),0,1, -.5,1.5) * width, 0 - this.avatarWidth, width + this.avatarWidth ) ;//constrain(this.x + this.random()*4, 0, width - (this.image.width/2));
      this.y = constrain( map(this.yRandom(), 0, 1, -.5, 1.5) * height, 0 - this.avatarHeight , height + this.avatarHeight );//constrain(this.y + this.random()*4, 0, height - (this.image.height/2));

      if(!collidePointRect(this.x,this.y,(500-100),0,(680+100),860)) {
            /*
            After it checks to see if the position is in the middle
            it then checks to see if the x and y are inside the screen
            I offset the detection by 100 for x and 200 for y
            We could not use the avatar width or height because
            of the animation they start at 0 or 1 pixel so the offset is so small
            // that they would still appear offscreen
            */
            if(this.x > 100 && this.x < windowWidth - 100 &&
              this.y > 200 && (this.y) < windowHeight - 200){
            console.log('x:'+this.x + ' y:'+this.y )

            this.avatarSetup =false;
            break;
          }
       }
    }

    this.x = constrain( map(this.random(),0,1, -.5,1.5) * width, 0 - this.avatarWidth, width + this.avatarWidth ) ;//constrain(this.x + this.random()*4, 0, width - (this.image.width/2));
    this.y = constrain( map(this.yRandom(), 0, 1, -.5, 1.5) * height, 0 - this.avatarHeight , height + this.avatarHeight );//constrain(this.y + this.random()*4, 0, height - (this.image.height/2));


    if(this.image.width != 1){ // this necessary until the image is loaded

      switch(this.state) {
        case 'avatarIsGrowing':
          this.avatarGrow();
          break;
        case 'avatarIsShrinking':
          this.avatarShrink();
          break;
        case 'avatarIsWalking':
          //this.avatarShrink();
          break;
      }

      this.calculateSpeed();

      var angle = sin(this.angleCounter * 2 * PI); //-1, 1
      angle =  round(angle * 1) / 1; // snap
      angle *= .75;

      var bounceOffset = sin((this.angleCounter + .25) * 2 * 2 * PI);
      //bounceOffset =  round(bounceOffset * 1) / 1; // snap
      bounceOffset *= 1.75;

      push();
      translate(this.x,this.y + bounceOffset);
      rotate(radians(angle));
      image(this.image,0-(this.avatarWidth/2),0-(this.avatarHeight),this.avatarWidth,this.avatarHeight);
      pop();


      var dT = (1/30.0); //delta time
      //console.log(speed);
      var animSpeed = map(this.speed, 0, 1, .6, .75);
      this.angleCounter = (this.angleCounter + dT * animSpeed);



    }
  }
}

function lerp(t, minn, maxx)
{
  return(t, 0, 1, minn, maxx);
}

function mousePressed() {
    //var a = new avatar('avatars/'+ Math.ceil(Math.random()*294)+'.png', random(0,width),random(0,height) )
    //avatars.push(a)
}

function keyPressed() {
  if (keyCode === LEFT_ARROW) {
     for (var i = 0; i < avatars.length; i++) {

       // if(avatars[i].id == 'aaa'){
          avatars[i].state = 'avatarIsShrinking';
          avatars[i].startTime = performance.now();
          avatars[i].endTime = avatars[i].startTime + duration2;
          soundReverse.playbackRate = random(.8,1.5);
          soundReverse.play();
      //}
        }
  }
}


